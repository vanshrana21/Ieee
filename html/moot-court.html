<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moot Court | Juris AI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/moot-court.css">
</head>
<body>
    <nav class="navbar">
        <div class="navbar-content">
            <div class="logo">Juris AI</div>
            <div class="navbar-right">
                <span class="navbar-module-label">Moot Court</span>
                <button class="back-btn" onclick="window.location.href='dashboard-student.html'">Dashboard</button>
            </div>
        </div>
    </nav>

    <main class="container">
        <!-- ==================== -->
        <!-- PROJECT LIST VIEW    -->
        <!-- ==================== -->
        <section id="projectListView" class="view">
            <div class="view-header">
                <div>
                    <h1 class="view-title">Moot Court Workspace</h1>
                    <p class="view-subtitle">Prepare, structure, and practice legal arguments like trained advocates.</p>
                </div>
                <button class="btn-primary" id="newProjectBtn">+ New Moot</button>
            </div>

            <div class="projects-grid" id="projectsGrid">
                <!-- Populated by JS -->
            </div>

            <div class="empty-state" id="emptyState">
                <div class="empty-icon">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
                        <polyline points="14 2 14 8 20 8"/>
                        <line x1="16" y1="13" x2="8" y2="13"/>
                        <line x1="16" y1="17" x2="8" y2="17"/>
                    </svg>
                </div>
                <h3>No moot projects yet</h3>
                <p>Create your first moot court project to begin structuring arguments.</p>
                <button class="btn-primary" id="emptyNewProjectBtn">Create First Moot</button>
            </div>
        </section>

        <!-- ==================== -->
        <!-- CREATE PROJECT VIEW  -->
        <!-- ==================== -->
        <section id="createProjectView" class="view hidden">
            <div class="view-header">
                <button class="btn-text" id="backToListBtn">&larr; Back to Projects</button>
            </div>

            <div class="form-container">
                <h2 class="form-title">New Moot Court Project</h2>

                <div class="form-group">
                    <label class="form-label" for="mootTitle">Moot Title <span class="required">*</span></label>
                    <input type="text" id="mootTitle" class="form-input" placeholder="e.g. National Moot Court Competition 2026 â€” Problem No. 3">
                </div>

                <div class="form-group">
                    <label class="form-label" for="mootProposition">Moot Proposition / Problem Statement <span class="required">*</span></label>
                    <textarea id="mootProposition" class="form-textarea" rows="8" placeholder="Paste the full moot proposition, case facts, or problem statement here..."></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="mootSide">Your Side <span class="required">*</span></label>
                        <div class="side-selector">
                            <button class="side-btn" data-side="petitioner" id="sidePetitioner">Petitioner</button>
                            <button class="side-btn" data-side="respondent" id="sideRespondent">Respondent</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="mootCourt">Court / Forum</label>
                        <input type="text" id="mootCourt" class="form-input" placeholder="e.g. Supreme Court of India, High Court, ICSID Tribunal">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="mootDomain">Legal Domain</label>
                    <input type="text" id="mootDomain" class="form-input" placeholder="e.g. Constitutional Law, Criminal Law, International Arbitration">
                </div>

                <div class="form-actions">
                    <button class="btn-secondary" id="cancelCreateBtn">Cancel</button>
                    <button class="btn-primary" id="createProjectBtn">Create Moot Project</button>
                </div>
            </div>
        </section>

        <!-- ==================== -->
        <!-- WORKSPACE VIEW       -->
        <!-- ==================== -->
        <section id="workspaceView" class="view hidden">
            <div class="workspace-header">
                <div class="workspace-nav">
                    <button class="btn-text" id="backToProjectsBtn">&larr; All Projects</button>
                </div>
                <div class="workspace-meta">
                    <h2 class="workspace-title" id="workspaceTitle"></h2>
                    <div class="workspace-badges">
                        <span class="badge badge-side" id="workspaceSide"></span>
                        <span class="badge badge-court" id="workspaceCourt"></span>
                        <span class="badge badge-domain" id="workspaceDomain"></span>
                    </div>
                </div>
                <div class="workspace-actions">
                    <button class="btn-icon btn-ai-toggle" id="toggleCoachBtn" title="Open AI Moot Coach">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
                        <span>AI Coach</span>
                    </button>
                    <button class="btn-icon btn-ai-toggle" id="toggleJudgeAssistBtn" title="Open Judge Assist">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
                        <span>Judge Assist</span>
                    </button>
                    <button class="btn-icon" id="viewPropositionBtn" title="View Moot Proposition">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></svg>
                        <span>Proposition</span>
                    </button>
                    <button class="btn-icon btn-danger" id="deleteProjectBtn" title="Delete Project">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
                    </button>
                </div>
            </div>

            <!-- Proposition Panel (collapsible) -->
            <div class="proposition-panel hidden" id="propositionPanel">
                <div class="proposition-header">
                    <span class="proposition-label">Moot Proposition</span>
                    <button class="btn-close" id="closePropositionBtn">&times;</button>
                </div>
                <div class="proposition-body" id="propositionBody"></div>
            </div>

            <!-- Issues + IRAC Layout -->
            <div class="workspace-layout">
                <!-- Left: Issue List -->
                <div class="issues-panel">
                    <div class="issues-header">
                        <h3 class="panel-title">Legal Issues</h3>
                        <button class="btn-small" id="addIssueBtn">+ Add Issue</button>
                    </div>
                    <p class="panel-hint">Frame each legal issue as a separate argument track. Drag to reorder by priority.</p>
                    <div class="issues-list" id="issuesList">
                        <!-- Populated by JS -->
                    </div>
                    <div class="issues-empty hidden" id="issuesEmpty">
                        <p>No issues framed yet. Add your first legal issue to begin structuring arguments.</p>
                    </div>
                </div>

                <!-- Right: IRAC Builder -->
                <div class="irac-panel" id="iracPanel">
                    <div class="irac-empty" id="iracEmpty">
                        <div class="irac-empty-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                            </svg>
                        </div>
                        <h3>Select an issue to begin</h3>
                        <p>Choose a legal issue from the panel on the left to open its IRAC workspace.</p>
                    </div>

                    <div class="irac-workspace hidden" id="iracWorkspace">
                        <div class="irac-workspace-header">
                            <div class="irac-issue-nav">
                                <button class="btn-small btn-ghost" id="prevIssueBtn" title="Previous Issue">&larr;</button>
                                <span class="irac-issue-counter" id="iracIssueCounter"></span>
                                <button class="btn-small btn-ghost" id="nextIssueBtn" title="Next Issue">&rarr;</button>
                            </div>
                            <div class="irac-status" id="iracStatus"></div>
                        </div>

                        <div class="irac-section">
                            <div class="irac-label">
                                <span class="irac-letter">I</span>
                                <span class="irac-name">Issue</span>
                            </div>
                            <textarea id="iracIssue" class="irac-textarea" rows="3" placeholder="State the legal question this issue raises. Frame it precisely as a question of law."></textarea>
                        </div>

                        <div class="irac-section">
                            <div class="irac-label">
                                <span class="irac-letter">R</span>
                                <span class="irac-name">Rule</span>
                            </div>
                            <textarea id="iracRule" class="irac-textarea" rows="5" placeholder="State the legal principle, statutory provision, or precedent applicable to this issue."></textarea>
                        </div>

                        <div class="irac-section">
                            <div class="irac-label">
                                <span class="irac-letter">A</span>
                                <span class="irac-name">Application</span>
                            </div>
                            <textarea id="iracApplication" class="irac-textarea" rows="6" placeholder="Apply the rule to the facts of the moot proposition. Connect law to fact with reasoning."></textarea>
                        </div>

                        <div class="irac-section">
                            <div class="irac-label">
                                <span class="irac-letter">C</span>
                                <span class="irac-name">Conclusion</span>
                            </div>
                            <textarea id="iracConclusion" class="irac-textarea" rows="3" placeholder="State the conclusion or prayer for relief on this issue."></textarea>
                        </div>

                        <!-- AI Review Button -->
                        <div class="ai-review-bar">
                            <button class="btn-ai btn-ai-review" id="aiReviewBtn" title="Get AI feedback on this IRAC block">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
                                AI Review
                            </button>
                            <button class="btn-ai btn-ai-counter" id="aiCounterBtn" title="Simulate opposing arguments">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
                                Counter-Argument
                            </button>
                            <span class="ai-label-tag">AI Guidance</span>
                        </div>

                        <!-- AI Review Output -->
                        <div class="ai-output-panel hidden" id="aiReviewOutput">
                            <div class="ai-output-header">
                                <span class="ai-output-title">AI Review</span>
                                <button class="btn-close" id="closeAiReview">&times;</button>
                            </div>
                            <div class="ai-output-body" id="aiReviewBody">
                                <!-- Populated by JS -->
                            </div>
                        </div>

                        <!-- Counter-Argument Output -->
                        <div class="ai-output-panel hidden" id="aiCounterOutput">
                            <div class="ai-output-header">
                                <span class="ai-output-title">Counter-Argument Simulator</span>
                                <button class="btn-close" id="closeAiCounter">&times;</button>
                            </div>
                            <div class="ai-output-body" id="aiCounterBody">
                                <!-- Populated by JS -->
                            </div>
                        </div>

                        <div class="irac-save-indicator" id="iracSaveIndicator">All changes saved</div>
                    </div>
                </div>
            </div>

            <!-- AI Coach Panel (slide-out, student side) -->
            <div class="ai-coach-panel hidden" id="aiCoachPanel">
                <div class="ai-coach-header">
                    <div class="ai-coach-title-row">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
                        <span>AI Moot Coach</span>
                    </div>
                    <button class="btn-close" id="closeCoachBtn">&times;</button>
                </div>
                <div class="ai-coach-info">Ask questions about your preparation. The coach will guide your thinking without writing for you.</div>
                <div class="ai-coach-messages" id="aiCoachMessages">
                    <!-- Chat messages appear here -->
                </div>
                <div class="ai-coach-input-area">
                    <textarea id="aiCoachInput" class="ai-coach-textarea" rows="2" placeholder="e.g. Is my Rule section too generic?"></textarea>
                    <button class="btn-ai btn-ai-send" id="aiCoachSendBtn">Ask Coach</button>
                </div>
            </div>

            <!-- Judge Assist Panel (separate, toggleable) -->
            <div class="judge-assist-overlay hidden" id="judgeAssistOverlay">
                <div class="judge-assist-panel">
                    <div class="judge-assist-header">
                        <div class="judge-assist-title-row">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
                            <span>Judge Assist</span>
                            <span class="ai-label-tag">Advisory Only</span>
                        </div>
                        <button class="btn-close" id="closeJudgeAssist">&times;</button>
                    </div>
                    <div class="judge-assist-info">AI-assisted analysis for evaluators. All output is advisory. Final scores and decisions remain yours.</div>
                    <div class="judge-assist-modes">
                        <button class="btn-ai judge-mode-btn active" data-mode="summarize">Summarize</button>
                        <button class="btn-ai judge-mode-btn" data-mode="compare">Compare</button>
                        <button class="btn-ai judge-mode-btn" data-mode="scoring_rationale">Scoring Rationale</button>
                    </div>
                    <div class="judge-assist-body" id="judgeAssistBody">
                        <p class="judge-assist-placeholder">Select a mode and click "Run Analysis" to begin.</p>
                    </div>
                    <div class="judge-assist-actions">
                        <button class="btn-ai btn-ai-send" id="judgeAssistRunBtn">Run Analysis</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Delete Confirmation Modal -->
    <div class="modal-overlay hidden" id="deleteModal">
        <div class="modal-box">
            <h3>Delete Moot Project</h3>
            <p id="deleteModalText">Are you sure you want to delete this project? This action cannot be undone.</p>
            <div class="modal-actions">
                <button class="btn-secondary" id="cancelDeleteBtn">Cancel</button>
                <button class="btn-danger" id="confirmDeleteBtn">Delete</button>
            </div>
        </div>
    </div>

    <!-- Issue Edit Modal -->
    <div class="modal-overlay hidden" id="issueModal">
        <div class="modal-box">
            <h3 id="issueModalTitle">Add Legal Issue</h3>
            <div class="form-group">
                <label class="form-label" for="issueText">Issue Statement</label>
                <textarea id="issueText" class="form-textarea" rows="3" placeholder="e.g. Whether the fundamental right to privacy under Article 21 was violated by the impugned legislation."></textarea>
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" id="cancelIssueBtn">Cancel</button>
                <button class="btn-primary" id="saveIssueBtn">Save Issue</button>
            </div>
        </div>
    </div>

    <script src="../js/moot-court.js"></script>
</body>
</html>
