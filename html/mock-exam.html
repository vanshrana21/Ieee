<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mock Exam - JurisAI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/mock-exam.css">
</head>
<body>
    <div id="examInstructions" class="instructions-overlay">
        <div class="instructions-card">
            <div class="instructions-header">
                <h1>Mock Examination</h1>
                <p class="exam-type-badge" id="examTypeBadge">Mock Exam</p>
            </div>
            
            <div class="instructions-content">
                <div class="exam-info-grid">
                    <div class="info-item">
                        <span class="info-label">Total Marks</span>
                        <span class="info-value" id="infoTotalMarks">80</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Duration</span>
                        <span class="info-value" id="infoDuration">180 min</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Questions</span>
                        <span class="info-value" id="infoQuestions">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Sections</span>
                        <span class="info-value" id="infoSections">-</span>
                    </div>
                </div>

                <div class="instructions-list">
                    <h3>Instructions</h3>
                    <ul>
                        <li>Read each question carefully before answering</li>
                        <li>Time will start immediately after you click "Start Exam"</li>
                        <li>Your answers are auto-saved as you type</li>
                        <li>You can flag questions for review using the flag button</li>
                        <li>Navigate between questions using the question palette</li>
                        <li>The exam will auto-submit when time expires</li>
                        <li><strong>Once submitted, answers cannot be changed</strong></li>
                    </ul>
                </div>

                <div class="exam-type-selector">
                    <label for="examTypeSelect">Select Exam Type:</label>
                    <select id="examTypeSelect">
                        <option value="mock_exam">Mock Exam (80 marks, 3 hours)</option>
                        <option value="end_semester">End Semester (80 marks, 3 hours)</option>
                        <option value="internal_assessment">Internal Assessment (30 marks, 1 hour)</option>
                        <option value="unit_test">Unit Test (20 marks, 45 min)</option>
                    </select>
                </div>

                <button class="btn-start-exam" id="btnStartExam" onclick="startExam()">
                    Start Exam
                </button>
            </div>
        </div>
    </div>

    <div id="examContainer" class="exam-container hidden">
        <header class="exam-header">
            <div class="header-left">
                <h1>Mock Examination</h1>
                <span class="subject-name" id="subjectName">General</span>
            </div>
            <div class="header-center">
                <div class="timer-container" id="timerContainer">
                    <svg class="timer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <polyline points="12 6 12 12 16 14"/>
                    </svg>
                    <span class="timer-display" id="timerDisplay">03:00:00</span>
                </div>
            </div>
            <div class="header-right">
                <button class="btn-submit" onclick="confirmSubmit()">
                    Submit Exam
                </button>
            </div>
        </header>

        <div class="exam-body">
            <aside class="question-palette">
                <div class="palette-header">
                    <h3>Questions</h3>
                    <div class="progress-info">
                        <span id="attemptedCount">0</span>/<span id="totalCount">0</span> answered
                    </div>
                </div>
                
                <div class="palette-legend">
                    <div class="legend-item">
                        <span class="legend-dot answered"></span>
                        <span>Answered</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-dot flagged"></span>
                        <span>Flagged</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-dot current"></span>
                        <span>Current</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-dot unanswered"></span>
                        <span>Not answered</span>
                    </div>
                </div>

                <div class="sections-container" id="sectionsContainer">
                </div>
            </aside>

            <main class="question-area">
                <div class="question-header">
                    <div class="question-info">
                        <span class="section-label" id="currentSection">Section A</span>
                        <span class="question-number" id="currentQuestionNumber">Question 1</span>
                        <span class="marks-badge" id="currentMarks">5 marks</span>
                    </div>
                    <button class="btn-flag" id="btnFlag" onclick="toggleFlag()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/>
                            <line x1="4" y1="22" x2="4" y2="15"/>
                        </svg>
                        <span>Flag for Review</span>
                    </button>
                </div>

                <div class="question-content">
                    <div class="question-text" id="questionText">
                        Loading question...
                    </div>
                    
                    <div class="guidelines" id="questionGuidelines">
                    </div>
                </div>

                <div class="answer-area">
                    <label for="answerTextarea">Your Answer:</label>
                    <textarea 
                        id="answerTextarea" 
                        placeholder="Type your answer here..."
                        oninput="handleAnswerInput()"
                    ></textarea>
                    <div class="answer-meta">
                        <span class="word-count"><span id="wordCount">0</span> words</span>
                        <span class="auto-save-indicator" id="autoSaveIndicator">Auto-saved</span>
                    </div>
                </div>

                <div class="question-navigation">
                    <button class="btn-nav btn-prev" onclick="navigateQuestion(-1)" id="btnPrev">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="15 18 9 12 15 6"/>
                        </svg>
                        Previous
                    </button>
                    <button class="btn-nav btn-next" onclick="navigateQuestion(1)" id="btnNext">
                        Next
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </button>
                </div>
            </main>
        </div>
    </div>

    <div id="submitModal" class="modal hidden">
        <div class="modal-backdrop" onclick="closeSubmitModal()"></div>
        <div class="modal-content">
            <h2>Submit Examination?</h2>
            <div class="submit-summary">
                <div class="summary-item">
                    <span class="summary-label">Questions Attempted</span>
                    <span class="summary-value" id="summaryAttempted">0/0</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Flagged for Review</span>
                    <span class="summary-value" id="summaryFlagged">0</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Time Remaining</span>
                    <span class="summary-value" id="summaryTimeRemaining">00:00:00</span>
                </div>
            </div>
            <p class="submit-warning">Once submitted, you cannot modify your answers.</p>
            <div class="modal-actions">
                <button class="btn-cancel" onclick="closeSubmitModal()">Continue Exam</button>
                <button class="btn-confirm" onclick="submitExam()">Submit Now</button>
            </div>
        </div>
    </div>

    <div id="timeWarningModal" class="modal hidden">
        <div class="modal-content warning">
            <h2>Time Warning!</h2>
            <p>Only <strong id="warningTimeLeft">5 minutes</strong> remaining!</p>
            <p>Please review and submit your answers.</p>
            <button class="btn-confirm" onclick="closeTimeWarning()">Continue</button>
        </div>
    </div>

    <div id="completionScreen" class="completion-screen hidden">
        <div class="completion-card">
            <div class="completion-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 11.08V12a10 10 0 11-5.93-9.14"/>
                    <polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
            </div>
            <h1>Exam Submitted!</h1>
            <p class="completion-status" id="completionStatus">Your exam has been submitted successfully.</p>
            
            <div class="completion-stats">
                <div class="stat-item">
                    <span class="stat-value" id="finalAttempted">0</span>
                    <span class="stat-label">Questions Answered</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="finalTotal">0</span>
                    <span class="stat-label">Total Questions</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="finalTime">00:00</span>
                    <span class="stat-label">Time Taken</span>
                </div>
            </div>

            <div class="completion-actions">
                <a href="dashboard.html" class="btn-secondary">Go to Dashboard</a>
                <a href="mock-exam.html" class="btn-primary">Take Another Exam</a>
            </div>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <script src="../js/api.js"></script>
    <script src="../js/mock-exam.js"></script>
</body>
</html>
